<div
  data-controller="project-subscription"
  data-project-subscription-project-id-value="<%= @project.id %>"
>
  <h1><%= @project.name %></h1>
  <%= link_to "Edit project", edit_user_project_path(current_user, @project) %>
  <%= link_to "Delete project", user_project_path(current_user, @project), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} %>
  <div class="posts">
    <div data-project-subscription-target="posts">
      <% @project.posts.each do |post| %>
        <%= render "posts/post", post: post %>
        <!-- Comments Modal -->
        <div class="modal fade" id=<%="commentModal#{post.id}"%> tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel"><%= "Comment as #{current_user.name}" %></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <div class="comments">
                  <div class="d-flex justify-content-center">
                    <%= simple_form_for [post, Comment.new],
                    html: {class: "post-form"} do |f|
                    %>
                      <%= f.input :content,
                        label: false,
                        placeholder: "Comment ##{post.id}",
                        wrapper_html: {class: "flex-grow-1"}
                      %>
                      <%= f.submit "Comment", class: "btn btn-primary mb-3" %>
                    <% end %>
                  </div>
                    <% post.comments.each do |comment| %>
                      <div class="comment">
                        <%= render "comments/comment", comment: comment %>
                      </div>
                    <% end %>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
    <div class="d-flex justify-content-center">
      <%= simple_form_for [@project, @post],
      html: { data: { action: "turbo:submit-end->project-subscription#resetForm" },
      class: "post-form"} do |f|
      %>
        <%= f.input :content,
          label: false,
          placeholder: "Message ##{@project.name}",
          wrapper_html: {class: "flex-grow-1"}
        %>
        <%= f.submit "Post", class: "btn btn-primary mb-3" %>
      <% end %>
    </div>
  </div>
</div>
